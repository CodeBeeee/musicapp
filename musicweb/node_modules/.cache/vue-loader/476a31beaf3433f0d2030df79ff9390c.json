{"remainingRequest":"C:\\Users\\WE\\Desktop\\毕业设计\\musicweb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\WE\\Desktop\\毕业设计\\musicweb\\src\\components\\admin\\BookInfo.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"C:\\Users\\WE\\Desktop\\毕业设计\\musicweb\\src\\components\\admin\\BookInfo.vue","mtime":1583578891314},{"path":"C:\\Users\\WE\\Desktop\\毕业设计\\musicweb\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"C:\\Users\\WE\\Desktop\\毕业设计\\musicweb\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\WE\\Desktop\\毕业设计\\musicweb\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\WE\\Desktop\\毕业设计\\musicweb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\WE\\Desktop\\毕业设计\\musicweb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.el-pagination__jump{\r\n    margin-left:34px;\r\n}\r\n.input-with-select{\r\n    width: 500px;\r\n    height: 33px;\r\n}\r\n.el-select .el-input {\r\n    width: 100px;\r\n    height: 30px;\r\n}\r\n.input-with-select .el-input-group__prepend {\r\n    background-color: #fff;\r\n}\r\n.input-with-select .el-input__inner{\r\n    width:400px;\r\n}\r\n.dialog{\r\n  width:2200px;\r\n  margin-left: -250px;\r\n  margin-top: -100px;\r\n}\r\n.editor {\r\n  line-height: normal !important;\r\n  height: 570px;   \r\n}\r\n.ql-editor{\r\n   height: 620px;   \r\n}\r\n.ql-container .ql-snow{\r\n    height: 620px;\r\n}\r\n.ql-view{\r\n   height: 650px;   \r\n   overflow: auto;\r\n} \r\n.ql-container.ql-snow{\r\n  height: 650px;\r\n}\r\n.el-select .el-input__inner {\r\n  width: 220px;\r\n}\r\n.ql-snow .ql-tooltip[data-mode=link]::before {\r\n  content: \"请输入链接地址:\";\r\n}\r\n \r\n.ql-snow .ql-tooltip.ql-editing a.ql-action::after {\r\n    border-right: 0px;\r\n    content: '保存';\r\n    padding-right: 0px;\r\n}\r\n\r\n.ql-snow .ql-tooltip[data-mode=video]::before {\r\n    content: \"请输入视频地址:\";\r\n}\r\n\r\n.ql-snow .ql-picker.ql-size .ql-picker-label::before,\r\n.ql-snow .ql-picker.ql-size .ql-picker-item::before {\r\n  content: '14px';\r\n}\r\n.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=small]::before,\r\n.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=small]::before {\r\n  content: '10px';\r\n}\r\n.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=large]::before,\r\n.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=large]::before {\r\n  content: '18px';\r\n}\r\n.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=huge]::before,\r\n.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=huge]::before {\r\n  content: '32px';\r\n}\r\n\r\n.ql-snow .ql-picker.ql-header .ql-picker-label::before,\r\n.ql-snow .ql-picker.ql-header .ql-picker-item::before {\r\n  content: '文本';\r\n}\r\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"1\"]::before,\r\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"1\"]::before {\r\n  content: '标题1';\r\n}\r\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"2\"]::before,\r\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"2\"]::before {\r\n  content: '标题2';\r\n}\r\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"3\"]::before,\r\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"3\"]::before {\r\n  content: '标题3';\r\n}\r\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"4\"]::before,\r\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"4\"]::before {\r\n  content: '标题4';\r\n}\r\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"5\"]::before,\r\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"5\"]::before {\r\n  content: '标题5';\r\n}\r\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"6\"]::before,\r\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"6\"]::before {\r\n  content: '标题6';\r\n}\r\n\r\n.ql-snow .ql-picker.ql-font .ql-picker-label::before,\r\n.ql-snow .ql-picker.ql-font .ql-picker-item::before {\r\n  content: '标准字体';\r\n}\r\n.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=serif]::before,\r\n.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=serif]::before {\r\n  content: '衬线字体';\r\n}\r\n.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=monospace]::before,\r\n.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=monospace]::before {\r\n  content: '等宽字体';\r\n}\r\n",{"version":3,"sources":["BookInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAooBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"BookInfo.vue","sourceRoot":"src/components/admin","sourcesContent":["<template>\r\n    <div>\r\n        <el-container>\r\n                <el-header>\r\n                    <!-- 通过 slot 来指定在 input 中前置或者后置内容。 -->\r\n                    <el-input placeholder=\"请输入内容\" v-model=\"searchinput\" class=\"input-with-select\" style=\"margin-top:30px;height:20px\" >\r\n                         <el-select v-model=\"select\" slot=\"prepend\" placeholder=\"请选择\">\r\n                            <el-option label=\"课程名称\" value=\"bookname\" style=\"width:100px;\"></el-option>\r\n                        </el-select>\r\n                        <el-button slot=\"append\" icon=\"el-icon-search\" @click=\"userSearch()\" ></el-button>\r\n                    </el-input>\r\n                </el-header>\r\n                <el-main>\r\n                    <el-table\r\n                        v-loading=\"loading\"\r\n                        :data=\"tableData\"\r\n                        border\r\n                        style=\"width: 100%\">\r\n                        <el-table-column\r\n                            fixed\r\n                            prop=\"id\"\r\n                            label=\"课程id\"\r\n                            width=\"50\">\r\n                        </el-table-column>\r\n                        <el-table-column\r\n                                prop=\"booktitle\"\r\n                                label=\"课程名字\"\r\n                                width=\"150\">\r\n                        </el-table-column>\r\n                        <el-table-column\r\n                                prop=\"bookcontent\"\r\n                                label=\"课程简介\"\r\n                                width=\"450px\">\r\n                        </el-table-column>\r\n                         \r\n                        <el-table-column\r\n                                prop=\"bookpeoplenum\"\r\n                                label=\"课程浏览人数\"\r\n                                width=\"50\">\r\n                        </el-table-column>\r\n                        <el-table-column\r\n                                label=\"课程封面\"\r\n                                width=\"auto\">\r\n                                <template slot-scope=\"scope\" >\r\n                                 <div v-if=\"imgurlData[scope.$index]!=null\">\r\n                                 <ul v-for=\"item,index in imgurlData[scope.$index]\"> \r\n                                      <img :src='getImgUrl(item)' style=\"width:200px;height:100px\"/>\r\n                                  </ul>\r\n                                 </div>\r\n                                 <div v-else>无图片</div>\r\n                                </template>\r\n                        </el-table-column>\r\n                        <el-table-column\r\n                                fixed=\"right\"\r\n                                label=\"操作\"\r\n                                width=\"530\">\r\n                        <template slot-scope=\"scope\">\r\n                            <el-button @click=\"aditwz(scope.row)\"  size=\"small\" type=\"primary\" plain>添加章节</el-button>\r\n                            <el-button @click=\"lookwz(scope.row)\"  size=\"small\" type=\"warning\" plain>查看章节</el-button>\r\n                            <el-button @click=\"deletewz(scope.row.id,scope.$index)\" size=\"small\" type=\"danger\" plain>删除课程</el-button>\r\n                            <el-button @click=\"addst(scope.row)\"  size=\"small\" type=\"success\" plain>添加答题</el-button>\r\n                            <el-button @click=\"lookst(scope.row)\"  size=\"small\" type=\"info\" plain>查看题库</el-button>\r\n                        </template>\r\n                    </el-table-column>\r\n                </el-table>\r\n                <!-- 分页代码 -->\r\n                <div class=\"block\">\r\n                    <el-pagination\r\n                        @size-change=\"handleSizeChange\"\r\n                        @current-change=\"handleCurrentChange\"\r\n                        :current-page=\"currentSize\"\r\n                        :page-sizes=\"[10, 15, 20, 25]\"\r\n                        :page-size=\"size\"\r\n                        layout=\"total, sizes, prev, pager, next, jumper\"\r\n                        >\r\n                    </el-pagination>\r\n                </div>\r\n            </el-main>\r\n            <el-dialog :visible.sync=\"wzEdit\" class=\"dialog\" v-loading=\"loading\" element-loading-text=\"视频正在上传,需等候1分钟左右,请稍等\" element-loading-spinner=\"el-icon-loading\" element-loading-background=\"rgba(0, 0, 0, 0.8)\">\r\n                    <div class=\"ql-editor\">\r\n                        <div>\r\n                            <el-form ref=\"form\" :model=\"form\" label-width=\"80px\">\r\n                                <el-form-item label=\"章节名称\">\r\n                                    <el-input v-model=\"form.zjtitle\" maxlength=\"35\" > </el-input>\r\n                                </el-form-item>\r\n                                <el-form-item label=\"视频上传\">\r\n                                     <el-upload\r\n                                        class=\"upload-demo\"\r\n                                        ref=\"upload\"\r\n                                        drag\r\n                                        action=\"ac\"\r\n                                        :limit=\"1\"\r\n                                        :on-exceed=\"handleExceed\"\r\n                                        :before-upload=\"beforeAvatarUpload\"\r\n                                        :http-request=\"uploadFile\"\r\n                                        :auto-upload=\"false\"\r\n                                        >\r\n                                        <i class=\"el-icon-upload\"></i>\r\n                                        <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\r\n                                        <div class=\"el-upload__tip\" slot=\"tip\">只能上传video/mp4文件，且不超过100M</div>\r\n                                    </el-upload>\r\n                                </el-form-item>\r\n                            </el-form>\r\n                        </div>\r\n                        \r\n                        <div>\r\n                            <quill-editor \r\n                                class=\"editor\"\r\n                                v-model=\"form.zjcontent\"\r\n                                ref=\"myQuillEditor\" \r\n                                :options=\"editorOption\" \r\n                                @blur=\"onEditorBlur($event)\" @focus=\"onEditorFocus($event)\"\r\n                                @change=\"onEditorChange($event)\">\r\n                            </quill-editor> \r\n                        </div>\r\n                        <el-form>\r\n                            <el-form-item>\r\n                                <el-button type=\"primary\" style=\"margin-top:180px;width:200px\" @click=\"add()\">添加章节</el-button>    \r\n                            </el-form-item>\r\n                        </el-form>\r\n                    </div>\r\n                </el-dialog>\r\n                <el-dialog :visible.sync=\"wzView\" class=\"dialog\">\r\n                    <div class=\"ql-view\">\r\n                         <div>\r\n                            <el-collapse v-model=\"activeName\" accordion style=\"padding:20px;\" v-for=\"item,index in zhangjieData\" @change=\"collhandleChange\">\r\n                                <el-collapse-item :title=\"item.zjtitle\" :name='index' style=\"padding:10px;\" >\r\n                                    <div style=\"width:80%;margin-left:10%;\">\r\n                                        <div style=\"width:80%;height:250px;margin-left:10%;\" v-if=\"item.zjvideopath!=null\">\r\n                                            <video :src=\"'http://localhost/upimg/'+item.zjvideopath\" controls=\"controls\" style=\"width:100%;height:100%;\">\r\n                                            您的浏览器不支持 video 标签。\r\n                                            </video>\r\n                                        </div>\r\n                                        <div v-html=\"item.zjcontent\" style=\"margin-top:30px;\"></div>\r\n                                    </div>\r\n                                </el-collapse-item>\r\n                            </el-collapse>\r\n                         </div>\r\n                    </div>\r\n                </el-dialog>\r\n                <el-dialog :visible.sync=\"tkView\" class=\"dialog\">\r\n                    <div class=\"ql-view\" style=\"padding:10px;\">\r\n                            <div style=\"width:100%;text-align:center;\"><h1>题库</h1></div>\r\n                            <el-card style=\"width:50%;margin-left:25%;margin-top:20px;\" v-for=\"item,index in problemData\">\r\n                                <div><h2>{{index+1}}.{{item.problemname}}</h2></div><br>\r\n                                <div :style=\"item.daan=='A'?'color:#66FF00':''\">A.{{item.atitle}}</div><br>\r\n                                <div :style=\"item.daan=='B'?'color:#66FF00':''\">B.{{item.btitle}}</div><br>\r\n                                <div :style=\"item.daan=='C'?'color:#66FF00':''\">C.{{item.ctitle}}</div><br>\r\n                                <div :style=\"item.daan=='D'?'color:#66FF00':''\">D.{{item.dtitle}}</div><br>\r\n                            </el-card>\r\n                    </div>\r\n                </el-dialog>\r\n        </el-container>\r\n         \r\n        <el-drawer\r\n            title=\"答题添加\"\r\n            :visible.sync=\"drawer\"\r\n            :direction=\"direction\"\r\n            style=\"height:2000px\"\r\n            >\r\n            <div style=\"width:1000px;\">\r\n                <div style=\"margin-left:600px;\">\r\n                    <el-form :model=\"problemform\" :rules=\"rules\" ref=\"info\" label-width=\"0px\" v-loading=\"loading\" >\r\n                        <el-form-item prop=\"problemname\">\r\n                            <el-input v-model=\"problemform.problemname\" placeholder=\"问题\" maxlength=\"35\" style=\"width:400px\">\r\n                            </el-input>\r\n                        </el-form-item>\r\n                        <el-form-item prop=\"atitle\">\r\n                            <el-input v-model=\"problemform.atitle\" placeholder=\"A选项答案\" maxlength=\"40\" style=\"width:400px\">\r\n                            </el-input>\r\n                        </el-form-item>\r\n                        <el-form-item prop=\"btitle\">\r\n                            <el-input v-model=\"problemform.btitle\" placeholder=\"B选项答案\" maxlength=\"40\" style=\"width:400px\">\r\n                            </el-input>\r\n                        </el-form-item>\r\n                        <el-form-item prop=\"ctitle\">\r\n                            <el-input v-model=\"problemform.ctitle\" placeholder=\"C选项答案\" maxlength=\"40\" style=\"width:400px\">\r\n                            </el-input>\r\n                        </el-form-item>\r\n                        <el-form-item prop=\"dtitle\">\r\n                            <el-input v-model=\"problemform.dtitle\" placeholder=\"D选项答案\" maxlength=\"15\" style=\"width:400px\">\r\n                            </el-input>\r\n                        </el-form-item>\r\n                    </el-form>\r\n                </div>\r\n                <div style=\"margin-left:600px;\">\r\n                    答案:\r\n                    <el-radio-group v-model=\"radio\" style=\"margin-top:50px;\">\r\n                        <el-radio :label=\"1\">A:{{problemform.atitle}}</el-radio><br>\r\n                        <el-radio :label=\"2\">B:{{problemform.btitle}}</el-radio><br>\r\n                        <el-radio :label=\"3\">C:{{problemform.ctitle}}</el-radio><br>\r\n                        <el-radio :label=\"4\">D:{{problemform.dtitle}}</el-radio><br>\r\n                    </el-radio-group>\r\n                </div>\r\n                <div> <el-button type=\"success\" @click=\"addproblem()\" style=\"margin-left:600px;width:400px;margin-top:20px;\">添加答题</el-button></div>\r\n            </div>\r\n        </el-drawer>\r\n    </div>\r\n    \r\n</template>\r\n\r\n<script>\r\n// 工具栏配置\r\nconst toolbarOptions = [\r\n  [\"bold\", \"italic\", \"underline\", \"strike\"], // 加粗 斜体 下划线 删除线\r\n  [\"blockquote\", \"code-block\"], // 引用  代码块\r\n  [{ header: 1 }, { header: 2 }], // 1、2 级标题\r\n  [{ list: \"ordered\" }, { list: \"bullet\" }], // 有序、无序列表\r\n  [{ script: \"sub\" }, { script: \"super\" }], // 上标/下标\r\n  [{ indent: \"-1\" }, { indent: \"+1\" }], // 缩进\r\n  // [{'direction': 'rtl'}],                         // 文本方向\r\n  [{ size: [\"small\", false, \"large\", \"huge\"] }], // 字体大小\r\n  [{ header: [1, 2, 3, 4, 5, 6, false] }], // 标题\r\n  [{ color: [] }, { background: [] }], // 字体颜色、字体背景颜色\r\n  [{ font: [] }], // 字体种类\r\n  [{ align: [] }], // 对齐方式\r\n  [\"clean\"], // 清除文本格式\r\n  [\"link\", \"image\", \"video\"] // 链接、图片、视频\r\n];\r\nimport { quillEditor } from \"vue-quill-editor\";\r\nimport \"quill/dist/quill.core.css\";\r\nimport \"quill/dist/quill.snow.css\";\r\nimport \"quill/dist/quill.bubble.css\";\r\nimport {addProblem,getProblem,getZhangjie,delBook,addZhangjie,addBookImg,findUserInfo,getUserCount,getUserSearch,delUser,updateUser,getPartStudent,delStudent,getPartBook} from '../../api/index';\r\nimport { log } from 'util';\r\nexport default {\r\n    props: {\r\n        /*编辑器的内容*/\r\n        value: {\r\n        type: String\r\n        },\r\n        /*图片大小*/\r\n        maxSize: {\r\n        type: Number,\r\n        default: 4000 //kb\r\n        }\r\n    },\r\n\r\n    components: {\r\n        quillEditor\r\n    },\r\n    name:\"userinfo\",\r\n    data(){\r\n        var checkPhone = (rule, value, callback) => {\r\n            const phoneReg = /^1[3|4|5|7|8][0-9]{9}$/\r\n            if (!value) {\r\n            return callback(new Error('电话号码不能为空'))\r\n            }\r\n            setTimeout(() => {\r\n            // Number.isInteger是es6验证数字是否为整数的方法,但是我实际用的时候输入的数字总是识别成字符串\r\n            // 所以我就在前面加了一个+实现隐式转换\r\n\r\n            if (!Number.isInteger(+value)) {\r\n                callback(new Error('请输入数字值'))\r\n            } else {\r\n                if (phoneReg.test(value)) {\r\n                callback()\r\n                } else {\r\n                callback(new Error('电话号码格式不正确'))\r\n                }\r\n            }\r\n            }, 100)\r\n        }\r\n        var checkEmail = (rule, value, callback) => {\r\n            const mailReg = /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/\r\n            if (!value) {\r\n            return callback(new Error('邮箱不能为空'))\r\n            }\r\n            setTimeout(() => {\r\n            if (mailReg.test(value)) {\r\n                callback()\r\n            } else {\r\n                callback(new Error('请输入正确的邮箱格式'))\r\n            }\r\n            }, 100)\r\n        }\r\n        return{\r\n            formdata:{\r\n               stpage:'',\r\n               pagesize:''     \r\n            },\r\n            searchform:{\r\n               search:'',\r\n               searchvalue:''     \r\n            },\r\n            problemform:{\r\n                bookid:'',\r\n                problemname:'',\r\n                daan:'',\r\n                atitle:'',\r\n                btitle:'',\r\n                ctitle:'',\r\n                dtitle:''\r\n            },\r\n            problemData:[],\r\n            wzEdit:false,\r\n            wzView:false,\r\n            drawer:false,\r\n            tkView:false,\r\n            direction: 'ttb',\r\n            A:'asdas',\r\n            B:'sa',\r\n            C:'asd',\r\n            D:'asd',\r\n            radio: 1,\r\n            form:{\r\n                bookid:'',\r\n                zjtitle:'',\r\n                zjcontent:'',\r\n                zjvideopath:''\r\n            },\r\n            formPicsData:{\r\n                name:''\r\n            },\r\n            fileList: [],\r\n            delform:{id:''},\r\n            searchinput: '',\r\n            select: '课程名称',\r\n            size:10,\r\n            currentSize:0,\r\n            total:0,\r\n            activeName: '1',\r\n            tableData:[],\r\n            imgurlData:[],\r\n            zhangjieData:[],\r\n            isimgup:false,\r\n            tkok:true,\r\n            zjcontent:'asdasdasda',\r\n            imgpath:'http://localhost/upimg/',\r\n            loading:false,\r\n            dialogFormVisible:false,\r\n            rowData:[],\r\n            formLabelWidth: '130px',\r\n            rules: {\r\n                problemname: [{ required: true, message: '请填写问题,不能为空', trigger: 'blur' }],\r\n                atitle: [{ required: true, message: '请填写选项答案,不能为空', trigger: 'blur' }],\r\n                btitle: [{ required: true, message: '请填写选项答案,不能为空', trigger: 'blur' }],\r\n                ctitle: [{ required: true, message: '请填写选项答案,不能为空', trigger: 'blur' }],\r\n                dtitle: [{ required: true, message: '请填写选项答案,不能为空', trigger: 'blur' }],\r\n            },\r\n            editorOption: {\r\n                    placeholder: \"\",\r\n                    theme: \"snow\", // or 'bubble'\r\n                    placeholder: \"您想说点什么？\",\r\n                    modules: {\r\n                    toolbar: {\r\n                        container: toolbarOptions,\r\n                        // container: \"#toolbar\",\r\n                        handlers: {\r\n                        image: function(value) {\r\n                            if (value) {\r\n                            // 触发input框选择图片文件\r\n                            document.querySelector(\".avatar-uploader input\").click();\r\n                            } else {\r\n                            this.quill.format(\"image\", false);\r\n                            }\r\n                        },\r\n                        // link: function(value) {\r\n                        //   if (value) {\r\n                        //     var href = prompt('请输入url');\r\n                        //     this.quill.format(\"link\", href);\r\n                        //   } else {\r\n                        //     this.quill.format(\"link\", false);\r\n                        //   }\r\n                        // },\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            header: {\r\n                token: sessionStorage.token\r\n            } // 有的图片服务器要求请求头需要有token\r\n\r\n        }   \r\n    },\r\n    methods:{\r\n        onEditorBlur() {\r\n        //失去焦点事件\r\n        },\r\n        onEditorFocus() {\r\n        //获得焦点事件\r\n        },\r\n        onEditorChange() {\r\n        //内容改变事件\r\n        this.$emit(\"input\", this.content);\r\n        },\r\n\r\n        // 富文本图片上传前\r\n        beforeUpload() {\r\n        // 显示loading动画\r\n        this.quillUpdateImg = true;\r\n        },\r\n        handleChange(response, file, fileList){\r\n            this.urlData.push(response.url);\r\n            console.log(response.url);\r\n        },\r\n        handleRemove(file,fileList){\r\n            this.urlData = [];\r\n            fileList.forEach(element => {\r\n            this.urlData.push(element.url);\r\n            });\r\n        },\r\n        uploadSuccess(res, file) {\r\n        // res为图片服务器返回的数据\r\n        // 获取富文本组件实例\r\n        console.log(file);\r\n        let quill = this.$refs.myQuillEditor.quill;\r\n        // 如果上传成功\r\n        if (res.code == 200) {\r\n            // 获取光标所在位置\r\n            let length = quill.getSelection().index;\r\n            // 插入图片  res.url为服务器返回的图片地址\r\n            quill.insertEmbed(length, \"image\", res.url);\r\n            // 调整光标到最后\r\n            quill.setSelection(length + 1);\r\n        } else {\r\n            this.$message.error(\"图片插入失败\");\r\n        }\r\n        // loading动画消失\r\n        this.quillUpdateImg = false;\r\n        },\r\n        // 富文本图片上传失败\r\n        uploadError() {\r\n        // loading动画消失\r\n        this.quillUpdateImg = false;\r\n        this.$message.error(\"图片插入失败\");\r\n        },\r\n        handleSizeChange(val) {\r\n            this.size = val;\r\n            // this.findMsg();\r\n            console.log(`每页 ${val} 条`);\r\n        },\r\n        handleCurrentChange(val) {\r\n            this.currentSize = val;\r\n            // this.findMsg();\r\n            console.log(`当前页: ${val}`);\r\n        },\r\n        beforeAvatarUpload(file) {\r\n            const isJPG = file.type === 'video/mp4';\r\n            const isLt2M = file.size / 1024 / 1024 < 100;\r\n\r\n            if (!isJPG) {\r\n            this.$message.error('上传视频文件是 MP4 格式!');\r\n            }\r\n            if (!isLt2M) {\r\n            this.$message.error('上传视频大小不能超过 50MB!');\r\n            }\r\n            return isJPG && isLt2M;\r\n        },\r\n        uploadFile(file){\r\n          this.isimgup = true;\r\n          this.formPicsData.append('file', file.file);\r\n        },\r\n        handleExceed(files, fileList) {\r\n            this.$message.warning(`当前限制选择 1 个文件，本次选择了 ${files.length} 个文件，共选择了 ${files.length + fileList.length} 个文件`);\r\n        },\r\n        add(row){\r\n            this.formPicsData = new FormData();\r\n            this.$refs.upload.submit();\r\n            this.loading = true;\r\n            if(this.isimgup==true){\r\n                addBookImg(this.formPicsData).then(res=>{\r\n                if(res.resCode==1){\r\n                    this.form.zjvideopath = res.webShowPath;\r\n                    console.log(this.form);\r\n                    this.addzj(this.form);\r\n                }else{\r\n                    this.$message.error(\"网络不好上传失败，请重新上传\");\r\n                    this.loading = false;\r\n                    this.wzEdit = false;\r\n                }\r\n                this.loading = false;\r\n            }).catch(res => {\r\n                this.loading = false;\r\n                this.$message.info(res);\r\n            });\r\n            }else{\r\n                this.form.zjvideopath = null;\r\n                this.addzj(this.form);\r\n                this.loading = false;\r\n            }\r\n            \r\n        },\r\n        addzj(val){\r\n            addZhangjie(val).then(res=>{\r\n                        if(res==1){\r\n                            this.$message.success(\"添加成功\");\r\n                        }else{\r\n                            this.$message.error(\"网络异常添加失败，请重新添加\");\r\n                        }\r\n                        this.wzEdit = false;\r\n                        this.loading = false;\r\n                    }).catch(res => {\r\n                        this.loading = false;\r\n                        this.wzEdit = false;\r\n                        this.$message.error(res);\r\n                    });\r\n        },\r\n        findMsg(){\r\n            this.loading=true;\r\n            this.formdata.pagesize = this.size;\r\n            this.formdata.stpage = (this.currentSize<=1?0:this.currentSize-1)*this.formdata.pagesize;\r\n            getPartBook(this.formdata).then(res=>{\r\n                console.log(res);\r\n                this.tableData = res.data;\r\n                this.imgurlData = [];\r\n                for(var k=0;k<this.tableData.length;k++){\r\n                    if(this.tableData[k].bookimgpath!=null){\r\n                        this.imgurlData[k] = this.tableData[k].bookimgpath.split(',');\r\n                    }else{\r\n                        this.imgurlData[k] = null;\r\n                    }\r\n                    \r\n                }\r\n                this.loading=false;\r\n            }).catch(err => {\r\n                this.$message.error(res);\r\n                this.loading=false;\r\n            })\r\n        },\r\n        aditwz(row){\r\n            this.form.bookid = row.id;\r\n            this.wzEdit = true; \r\n        },\r\n        lookwz(row){\r\n            console.log(row.id);\r\n            getZhangjie(row.id).then(res=>{\r\n                console.log(res);\r\n                if(res.data.length==0){\r\n                    this.$message.error(\"暂无章节,请添加\");\r\n                }else{\r\n                    this.zhangjieData = res.data;\r\n                    this.wzView = true;\r\n                }\r\n            })\r\n        },\r\n        addst(row){\r\n            this.drawer = true;\r\n            console.log(\"id=\"+row.id);\r\n            this.problemform.bookid = row.id;\r\n        }, \r\n        lookst(row){\r\n            getProblem(row.id).then(res=>{\r\n                console.log(res);\r\n                if(res.data.length==0){\r\n                    this.$message.error(\"暂无题库,请添加\");\r\n                }else{\r\n                    this.problemData = res.data; \r\n                    this.tkView = true;\r\n                }\r\n                \r\n            })\r\n        },\r\n        addproblem(){\r\n            console.log(this.radio);\r\n            if(this.radio=='1'){\r\n                this.problemform.daan = 'A';\r\n            }else if(this.radio=='2'){\r\n                this.problemform.daan = 'B';\r\n            }else if(this.radio=='3'){\r\n                this.problemform.daan = 'C';\r\n            }else if(this.radio=='4'){\r\n                this.problemform.daan = 'D';\r\n            }\r\n            this.$refs.info.validate(valid => {\r\n                if(valid){\r\n                    this.loading = true;\r\n                    addProblem(this.problemform).then(res=>{\r\n                        console.log(res.data);\r\n                        if(res==1){\r\n                            this.$message.success(\"添加成功\");\r\n                        }else{\r\n                            this.$message.error(\"添加失败,请重新添加\");\r\n                        }\r\n                        this.loading = false;\r\n                    }).catch(err => {\r\n                        this.$message.error(res);\r\n                        this.loading=false;\r\n                    })\r\n                }else{\r\n                    this.$message.error('请正确输入信息');\r\n                    return false;\r\n                }\r\n            })\r\n        },\r\n\r\n        collhandleChange(val){\r\n            console.log(val);\r\n        },\r\n        deletewz(uid,index){\r\n            this.$confirm('您确认删除该学生信息了吗?', '提示', {\r\n            confirmButtonText: '确定',\r\n            cancelButtonText: '取消',\r\n            type: 'warning',\r\n            }).then(() => {\r\n                    this.loading=true;\r\n                    this.dialogFormVisible = false;\r\n                    this.delform.id = uid;\r\n                    delBook(this.delform).then(res=>{\r\n                        if(res==1){\r\n                            this.tableData.splice(index,1);//删除掉tableData数组上的第index个元素\r\n                            this.imgurlData.splice(index,1);\r\n                            this.loading=false;\r\n                            this.$message.success(\"删除成功\");\r\n                        }else{\r\n                            this.loading=false;\r\n                            this.$message.error(\"删除失败\");\r\n                        }\r\n                    }).catch(err => {\r\n                        this.$message.error('服务器出错');\r\n                        this.loading=false;\r\n                    })\r\n                 }).catch(() => {\r\n                    this.dialogFormVisible = false;\r\n                    this.loading=false;\r\n                     \r\n                });\r\n        },\r\n        getImgUrl(val){\r\n            console.log(this.imgpath+val);\r\n            return this.imgpath+val;\r\n        },\r\n        deleteClick(uid,index){\r\n            \r\n        },\r\n        \r\n    },\r\n           \r\n    created(){\r\n        this.findMsg();\r\n    },\r\n    watch:{\r\n        select(val,oldvalue){\r\n            this.searchform.search = val;\r\n        },\r\n        $route(to,from){\r\n            if(to.path=='/bookinfo'){\r\n                 this.findMsg();\r\n            }\r\n        }\r\n    }\r\n}\r\n</script>\r\n<style>\r\n.el-pagination__jump{\r\n    margin-left:34px;\r\n}\r\n.input-with-select{\r\n    width: 500px;\r\n    height: 33px;\r\n}\r\n.el-select .el-input {\r\n    width: 100px;\r\n    height: 30px;\r\n}\r\n.input-with-select .el-input-group__prepend {\r\n    background-color: #fff;\r\n}\r\n.input-with-select .el-input__inner{\r\n    width:400px;\r\n}\r\n.dialog{\r\n  width:2200px;\r\n  margin-left: -250px;\r\n  margin-top: -100px;\r\n}\r\n.editor {\r\n  line-height: normal !important;\r\n  height: 570px;   \r\n}\r\n.ql-editor{\r\n   height: 620px;   \r\n}\r\n.ql-container .ql-snow{\r\n    height: 620px;\r\n}\r\n.ql-view{\r\n   height: 650px;   \r\n   overflow: auto;\r\n} \r\n.ql-container.ql-snow{\r\n  height: 650px;\r\n}\r\n.el-select .el-input__inner {\r\n  width: 220px;\r\n}\r\n.ql-snow .ql-tooltip[data-mode=link]::before {\r\n  content: \"请输入链接地址:\";\r\n}\r\n \r\n.ql-snow .ql-tooltip.ql-editing a.ql-action::after {\r\n    border-right: 0px;\r\n    content: '保存';\r\n    padding-right: 0px;\r\n}\r\n\r\n.ql-snow .ql-tooltip[data-mode=video]::before {\r\n    content: \"请输入视频地址:\";\r\n}\r\n\r\n.ql-snow .ql-picker.ql-size .ql-picker-label::before,\r\n.ql-snow .ql-picker.ql-size .ql-picker-item::before {\r\n  content: '14px';\r\n}\r\n.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=small]::before,\r\n.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=small]::before {\r\n  content: '10px';\r\n}\r\n.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=large]::before,\r\n.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=large]::before {\r\n  content: '18px';\r\n}\r\n.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=huge]::before,\r\n.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=huge]::before {\r\n  content: '32px';\r\n}\r\n\r\n.ql-snow .ql-picker.ql-header .ql-picker-label::before,\r\n.ql-snow .ql-picker.ql-header .ql-picker-item::before {\r\n  content: '文本';\r\n}\r\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"1\"]::before,\r\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"1\"]::before {\r\n  content: '标题1';\r\n}\r\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"2\"]::before,\r\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"2\"]::before {\r\n  content: '标题2';\r\n}\r\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"3\"]::before,\r\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"3\"]::before {\r\n  content: '标题3';\r\n}\r\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"4\"]::before,\r\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"4\"]::before {\r\n  content: '标题4';\r\n}\r\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"5\"]::before,\r\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"5\"]::before {\r\n  content: '标题5';\r\n}\r\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"6\"]::before,\r\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"6\"]::before {\r\n  content: '标题6';\r\n}\r\n\r\n.ql-snow .ql-picker.ql-font .ql-picker-label::before,\r\n.ql-snow .ql-picker.ql-font .ql-picker-item::before {\r\n  content: '标准字体';\r\n}\r\n.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=serif]::before,\r\n.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=serif]::before {\r\n  content: '衬线字体';\r\n}\r\n.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=monospace]::before,\r\n.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=monospace]::before {\r\n  content: '等宽字体';\r\n}\r\n</style>"]}]}